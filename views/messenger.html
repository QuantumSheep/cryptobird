<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/style.css">
</head>

<body>
    <div class="position-absolute rpanel">
        <span id="connected"></span>
        <i class="fas fa-male"></i>
    </div>
    <div class="d-flex flex-column h-100 w-100">
        <ul id="messages" class="h-100 m-0 p-0"></ul>
        <form id="input" class="d-flex w-100 border-top m-0" action="">
            <div class="w-100">
                <input class="form-control w-100 p-2" name="username" placeholder="Username">
                <input class="form-control w-100 p-2" name="m" autocomplete="off" placeholder="Message">
            </div>
            <button type="submit" class="btn btn-primary bg-primary text-white m-0">Send</button>
        </form>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        socket.on('chat message', msg => {
            document.getElementById("messages").innerHTML += `<li>${msg}</li>`;
            document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight -
                document.getElementById("messages").clientHeight;
        });

        socket.on('infos connected', num => {
            document.getElementById("connected").innerHTML = num;
        });

        document.getElementById("input").addEventListener("submit", e => {
            e.preventDefault();

            socket.emit('chat message', e.target.username.value, e.target.m.value);

            e.target.m.value = "";

            return false;
        });
    </script>
</body>

</html>